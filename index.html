<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù‡ÙˆØ§ØªÙ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Font Awesome CDN (Ø¥Ù† Ø±ØºØ¨Øª Ø¨Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø§Ø­Ù‚Ù‹Ø§) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <style>
/* Ø§Ù„Ø®Ø· ÙˆØ§Ù„Ø®Ù„ÙÙŠØ© */
body {
  background: #f7f8fb;
  font-family: Tahoma, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  color: #222;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¨Ø­Ø« */
.search-modal-box {
  max-width: 720px;
  margin: 48px auto;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 6px 22px rgba(13, 110, 253, 0.06);
  padding: 26px;
}

/* Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø« */
.search-field {
  width: 100%;
  padding: 12px 14px;
  border: 2px solid #e6e9ee;
  border-radius: 12px;
  font-size: 16px;
  transition: box-shadow .15s, border-color .15s;
}
.search-field:focus {
  outline: none;
  border-color: #bcd7ff;
  box-shadow: 0 6px 18px rgba(13,110,253,0.06);
}

/* Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« */
#result {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  justify-content: center;
}

/* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
.phone-card {
  background: #fff;
  border-radius: 14px;
  border: 1px solid rgba(12, 28, 55, 0.04);
  box-shadow: 0 6px 18px rgba(22, 28, 45, 0.06);
  transition: .18s;
  cursor: pointer;
  overflow: hidden;
}
.phone-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 18px 40px rgba(13, 110, 253, 0.08);
}

/* ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
.phone-card .card-img-top {
  width: 100%;
  height: 180px;
  object-fit: cover;
}

/* Ù†Øµ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
.phone-card .card-body {
  padding: 14px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.phone-card .card-title {
  font-size: 15px;
  font-weight: 700;
  color: #0d6efd;
  text-align: center;
  min-height: 46px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Ø£Ø²Ø±Ø§Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
.chipset-btn,
.model-btn {
  display: block;
  width: 100%;
  text-align: left;
  direction: ltr;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-size: 13px;
  border-radius: 8px;
}
.chipset-btn { border-color: rgba(13,110,253,0.15); color: #0d6efd; }
.model-btn { border-color: rgba(25,135,84,0.12); color: #198754; }

/* ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© */
.col-lg-custom { flex: 0 0 20%; max-width: 20%; }
@media (max-width: 1199px) { .col-lg-custom { flex: 0 0 33.33%; max-width: 33.33%; } }
@media (max-width: 767px) { .col-lg-custom { flex: 0 0 48%; max-width: 48%; } }
@media (max-width: 479px) { .col-lg-custom { flex: 0 0 100%; max-width: 100%; } }

/* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ - Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª */
.aps-feature-card {
  background: linear-gradient(180deg, #f8fbff 0%, #ffffff 100%);
  padding: 16px;
  border-radius: 12px;
  box-shadow: 0 6px 18px rgba(12, 28, 55, 0.04);
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
.aps-list-icon {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
  margin-bottom: 10px;
  color: #fff;
}

.aps-icon-mobile { background:#0d6efd; }
.aps-icon-mobile::before { content:"ğŸ“±"; }
.aps-icon-cpu { background:#198754; }
.aps-icon-cpu::before { content:"ğŸ§ "; }
.aps-icon-camera { background:#fd7e14; }
.aps-icon-camera::before { content:"ğŸ“¸"; }
.aps-icon-hdd { background:#6f42c1; }
.aps-icon-hdd::before { content:"ğŸ’¾"; }
.aps-icon-code { background:#20c997; }
.aps-icon-code::before { content:"âš™ï¸"; }
.aps-icon-battery { background:#ffc107; color:#000; }
.aps-icon-battery::before { content:"ğŸ”‹"; }

/* ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
.nav-tabs { overflow-x:auto; white-space:nowrap; flex-wrap:nowrap !important;}
.nav-tabs .nav-link { font-weight:600; color:#0d6efd; border-radius:12px 12px 0 0; margin:2px; }
.nav-tabs .nav-link.active { background:#0d6efd; color:#fff; }

.tab-content ul li {
  border-bottom: 1px solid #eee;
  padding: 6px 0;
}

    </style>
  </head>
  <body>
    <div class="container my-4">
      <!-- âœ… Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø¨Ø·Ø§Ù‚Ø© -->
      <div class="card mb-4 shadow-sm">
        <div class="card-body">
          <h5 class="text-center mb-3 fw-bold text-primary">ğŸ” Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù‡ÙˆØ§ØªÙ</h5>
          <form id="searchForm" class="text-center">
            <p class="message mb-3">Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ø¨Ø­Ø« Ø«Ù… Ø§Ø¶ØºØ· Ø²Ø± Ø§Ù„Ø¨Ø­Ø« Ø£Ùˆ <em>Enter</em></p>
            <input
              type="search"
              class="search-field form-control mb-3 text-center"
              id="phoneInput"
              name="s"
              placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„Ù‡Ø§ØªÙ..."
              required
            />
            <button type="submit" class="btn btn-primary w-100 py-2 fw-bold">Ø¨Ø­Ø«</button>
          </form>
        </div>
      </div>
<!-- ğŸ“¦ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø¨Ø·Ø§Ù‚Ø© -->
<div class="container my-4">
  <div class="card shadow-sm border-0 rounded-4">
    <div class="card-body">
      <h5 class="text-center mb-4 text-primary fw-bold">ğŸ“± Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«</h5>
      <!-- âœ… Ù…ÙƒØ§Ù† Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª -->
      <div id="result" class="row g-4 justify-content-center"></div>
    </div>
  </div>
</div>
   <!-- ğŸŸ¢ Ù…ÙˆØ¯Ø§Ù„ Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª -->
    <div class="modal fade" id="specsModal" tabindex="-1" aria-labelledby="specsModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content shadow-lg rounded-4">
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title" id="modalTitle">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‡Ø§ØªÙ</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body" id="specsModalBody">
            <div class="text-center py-5">
              <div class="spinner-border text-primary" role="status"></div>
              <p class="mt-3 text-muted">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      async function getDetails(url, phoneImg) {
        const modalBody = document.getElementById("specsModalBody");
        modalBody.innerHTML = `<div class='alert alert-info text-center'>ğŸ“± Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª...</div>`;

        try {
          const res = await fetch(`/api/details?url=${encodeURIComponent(url)}`);
          const data = await res.json();

          if (data.error) {
            modalBody.innerHTML = `<div class='alert alert-danger text-center'>âŒ ${data.error}</div>`;
            return;
          }

          const sections = {
            "Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©": ["Ø§Ù„Ø¥ØµØ¯Ø§Ø±", "Ø§Ù„Ù…Ø§Ø±ÙƒØ©", "Ø§Ù„Ø§Ø³Ù…", "Ø§Ù„Ù†ÙˆØ¹", "Ø§Ù„Ø®Ø§Ù…Ø©"],
            Ø§Ù„Ø³Ø¹Ø±: ["Ø§Ù„Ø³Ø¹Ø±", "Price", "Ø§Ù„Ø£Ø³Ø¹Ø§Ø±"],
            Ø§Ù„Ù†Ø¸Ø§Ù…: ["Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„", "Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©", "Ø§Ù„Ø¥ØµØ¯Ø§Ø±"],
            Ø§Ù„Ø´Ø§Ø´Ø©: ["Ø§Ù„Ø´Ø§Ø´Ø©", "Ø§Ù„Ù†ÙˆØ¹", "Ø§Ù„Ø¯Ù‚Ø©", "Ø§Ù„Ø³Ø·ÙˆØ¹", "Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«"],
            Ø§Ù„Ø°Ø§ÙƒØ±Ø©: ["Ø§Ù„Ø°Ø§ÙƒØ±Ø©", "Ø§Ù„ØªØ®Ø²ÙŠÙ†", "SD", "Ø§Ù„Ø±Ø§Ù…"],
            Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯: ["Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯", "Ø§Ù„ÙˆØ²Ù†", "Ø§Ù„Ø­Ø¬Ù…"],
            Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§: ["Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§", "Ø§Ù„Ø®Ù„ÙÙŠØ©", "Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©", "Ø§Ù„ÙÙŠØ¯ÙŠÙˆ"],
            // "Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©": ["Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©","Ø§Ù„Ø´Ø­Ù†","Ø§Ù„Ø³Ø¹Ø©"],
            Ø§Ù„ØµÙˆØª: ["Ø§Ù„ØµÙˆØª", "Ø³Ù…Ø§Ø¹Ø§Øª", "Ø¬Ø§Ùƒ"],
            Ø£Ø®Ø±Ù‰: [],
          };

          const icons = {
            "Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©": "ğŸ“‹",
            Ø§Ù„Ø³Ø¹Ø±: "ğŸ’°",
            Ø§Ù„Ù†Ø¸Ø§Ù…: "âš™ï¸",
            Ø§Ù„Ø´Ø§Ø´Ø©: "ğŸ“±",
            Ø§Ù„Ø°Ø§ÙƒØ±Ø©: "ğŸ’¾",
            Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯: "ğŸ“",
            Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§: "ğŸ“¸",
            Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©: "ğŸ”‹",
            Ø§Ù„ØµÙˆØª: "ğŸ”ˆ",
            Ø£Ø®Ø±Ù‰: "ğŸ“",
          };

          // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
          const grouped = {};
          for (const [key, val] of Object.entries(data.specs)) {
            let found = false;
            for (const [section, keywords] of Object.entries(sections)) {
              if (keywords.some((k) => key.includes(k))) {
                (grouped[section] ??= []).push({ key, val });
                found = true;
                break;
              }
            }
            if (!found) (grouped["Ø£Ø®Ø±Ù‰"] ??= []).push({ key, val });
          }

          const tabs = Object.keys(sections);
          const navTabs = tabs
            .map(
              (tab, i) => `
      <li class="nav-item" role="presentation">
        <button class="nav-link ${i === 0 ? "active" : ""}" id="tab-${i}" data-bs-toggle="tab" data-bs-target="#content-${i}" type="button" role="tab">
          ${icons[tab]} ${tab}
        </button>
      </li>`
            )
            .join("");

          const tabContents = tabs
            .map((tab, i) => {
              if (tab === "Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©") {
                const mainImage =
                  phoneImg || data.img || "https://telfonak.com/wp-content/uploads/2023/12/huawei-y9-prime-2019.webp";

                return `
<div class="tab-pane fade show active" id="content-${i}" role="tabpanel">
  <div class="d-flex flex-column flex-lg-row align-items-center gap-4">

    <!-- Ø§Ù„ØµÙˆØ±Ø© -->
    <div class="text-center flex-shrink-0">
      <div class="aps-main-image mb-3">
        <img fetchpriority="high" class="aps-image-zoom rounded shadow-sm" 
             src="${mainImage}" 
             style="width:100%; max-width:400px;" 
             alt="${data.title}">
        <div class="aps-img-loader"><span class="aps-loader"></span></div>
      </div>
      <h4 class="fw-bold mt-2">${data.title}</h4>
    </div>

    <!-- Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª -->
    <div class="flex-grow-1 w-100">
      <div class="row g-3 justify-content-start">
        ${[
          {
            key: "Ø§Ù„Ø´Ø§Ø´Ø©",
            val: (() => {
              const screenRaw = data.specs["Ø§Ù„Ø´Ø§Ø´Ø©"] || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©";

              if (screenRaw === "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©") return screenRaw;

              // ğŸ” Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†ÙˆØ¹ Ø§Ù„Ø´Ø§Ø´Ø©
              const typeMatch = screenRaw.match(/(IPS\s*LCD|AMOLED|OLED|Super\s*AMOLED|LTPO|PLS|TFT)/i);
              const type = typeMatch ? typeMatch[0].replace(/\s+/g, " ").trim().toUpperCase() : "";

              // ğŸ” Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø­Ø¬Ù… Ø¨Ø§Ù„Ø¨ÙˆØµØ©
              const sizeMatch = screenRaw.match(/(\d+(\.\d+)?)\s*(Ø¨ÙˆØµØ©|Ø¨ÙˆØµÙ‡|inch|")/i);
              const size = sizeMatch ? `${sizeMatch[1]} Ø¨ÙˆØµØ©` : "";

              // ğŸ” Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¯Ù‚Ø©
              let res = "";
              if (/FHD/i.test(screenRaw)) res = "Ø¨Ø¯Ù‚Ø© FHD+";
              else if (/HD\+/i.test(screenRaw)) res = "Ø¨Ø¯Ù‚Ø© HD+";
              else if (/QHD/i.test(screenRaw)) res = "Ø¨Ø¯Ù‚Ø© QHD+";
              else if (/UHD|4K/i.test(screenRaw)) res = "Ø¨Ø¯Ù‚Ø© 4K";
              else {
                const resMatch = screenRaw.match(/(\d{3,4})\s*[xÃ—]\s*(\d{3,4})/i);
                if (resMatch) {
                  const width = Math.max(resMatch[1], resMatch[2]);
                  res = width >= 2000 ? "Ø¨Ø¯Ù‚Ø© FHD+" : "Ø¨Ø¯Ù‚Ø© HD+";
                }
              }

              // ğŸ“± ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
              if (type || size || res) {
                return `${type}${type && size ? " Ø¨Ø­Ø¬Ù… " : ""}${size}${(type || size) && res ? " " : ""}${res}`.trim();
              } else {
                return screenRaw;
              }
            })(),
            icon: "aps-icon-mobile",
          },

          { key: "Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬", val: data.specs["Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬"] || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯", icon: "aps-icon-cpu" },
          {
            key: "Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§Øª",
            val: (() => {
              const backRaw = data.specs["ÙƒØ§Ù…ÙŠØ±Ø§ Ø®Ù„ÙÙŠØ©"] || data.specs["Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø®Ù„ÙÙŠØ©"] || "";
              const frontRaw = data.specs["ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù…Ø§Ù…ÙŠØ©"] || data.specs["Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©"] || "";

              const extractMP = (text) => {
                const matches = text.match(/(\d+)\s*(?:Ù…ÙŠØ¬Ø§|Ù…\.Ø¨)/g); // ÙÙ‚Ø· Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØªØ¨ÙˆØ¹Ø© Ø¨Ù…ÙŠØ¬Ø§ Ø£Ùˆ Ù….Ø¨
                if (!matches) return "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©";
                const clean = matches.map((m) => m.replace(/\D/g, "")); // Ù†Ø­Ø°Ù Ø£ÙŠ Ø­Ø±ÙˆÙ ÙˆÙ†Ø­ØªÙØ¸ Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·
                return clean.join("+") + " Ù….Ø¨";
              };

              const back = extractMP(backRaw);
              const front = extractMP(frontRaw);

              if (back !== "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©" && front !== "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©") {
                return `Ø®Ù„ÙÙŠØ© ${back} / Ø£Ù…Ø§Ù…ÙŠØ© ${front}`;
              } else if (back !== "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©") {
                return `Ø®Ù„ÙÙŠØ© ${back}`;
              } else if (front !== "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©") {
                return `Ø£Ù…Ø§Ù…ÙŠØ© ${front}`;
              } else {
                return "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©";
              }
            })(),
            icon: "aps-icon-camera",
          },

          {
            key: "Ø§Ù„Ø°Ø§ÙƒØ±Ø© + Ø§Ù„Ø±Ø§Ù…",
            val: (() => {
              // ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø© Ù„Ù„Ø°Ø§ÙƒØ±Ø© ÙˆØ§Ù„Ø±Ø§Ù…
              const storageKey = Object.keys(data.specs).find((k) => /Ø°Ø§ÙƒØ±Ø©|ØªØ®Ø²ÙŠÙ†|Ø¯Ø§Ø®Ù„ÙŠØ©/i.test(k)) || "";
              const ramKey = Object.keys(data.specs).find((k) => /Ø±Ø§Ù…|Ø§Ù„Ø±Ø§Ù…Ø§Øª|Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©/i.test(k)) || "";

              const storage = storageKey ? data.specs[storageKey].replace(/\s*\.\s*$/, "") : "";
              const ram = ramKey ? data.specs[ramKey].replace(/\s*\.\s*$/, "") : "";

              if (storage && ram) return `${storage} + ${ram}`;
              else if (storage) return storage;
              else if (ram) return ram;
              else return "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©";
            })(),
            icon: "aps-icon-hdd",
          },

          { key: "Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„", val: data.specs["Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„"] || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯", icon: "aps-icon-code" },
          {
            key: "Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©",
            val: (() => {
              // ğŸ”‹ Ø¬Ù„Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹
              const capacity = data.specs["Ø³Ø¹Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©"] || data.specs["Battery Capacity"] || "";
              const charging = data.specs["Ù‚Ø¯Ø±Ø© Ø§Ù„Ø´Ø­Ù†"] || data.specs["Ø§Ù„Ø´Ø­Ù†"] || "";

              if (!capacity && !charging) return "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©";

              // âš™ï¸ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†ØµÙˆØµ Ù‚Ù„ÙŠÙ„Ø§Ù‹
              const capClean =
                capacity
                  .replace(/Ù…Ù„ÙŠ|Ù…Ù„Ù„ÙŠ|mAh/gi, "")
                  .trim()
                  .replace(/\.+$/, "") + " Ù….Ø£";
              const chargeClean = charging.replace(/ÙˆØ§Ø·|W/gi, "").trim().replace(/\.+$/, "") + " ÙˆØ§Ø·";

              // ğŸ§© Ø¯Ù…Ø¬ Ø§Ù„Ù†Ø§ØªØ¬ Ø¨Ø´ÙƒÙ„ Ù…Ù†Ø³Ù‚
              if (capacity && charging) return `${capClean} / ${chargeClean}`;
              if (capacity) return capClean;
              if (charging) return chargeClean;
              return "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©";
            })(),
            icon: "aps-icon-battery",
          },
        ]
          .map(
            (item) => `
          <div class="col-12 col-md-6">
            <div class="aps-feature-card">
              <div class="aps-list-icon ${item.icon}"></div>
              <div class="aps-feature-info text-center mt-2">
                <strong>${item.key}</strong><br>
                <span>${item.val}</span>
              </div>
            </div>
          </div>`
          )
          .join("")}
      </div>
    </div>

  </div>
</div>`;
              }

              if (tab === "Ø§Ù„Ø³Ø¹Ø±") {
                const priceVal = grouped["Ø§Ù„Ø³Ø¹Ø±"]?.[0]?.val || "ØºÙŠØ± Ù…ØªÙˆÙØ±";
                return `<div class="tab-pane fade" id="content-${i}" role="tabpanel">
          <div class="card border-success text-center shadow-sm p-4 bg-light">
            <h4 class="text-success fw-bold mb-3">ğŸ’° Ø§Ù„Ø³Ø¹Ø±</h4>
            <p class="fs-4 text-success">${priceVal}</p>
          </div>
        </div>`;
              }

              const sectionItems = grouped[tab]?.length
                ? grouped[tab]
                    .map(
                      (item) =>
                        `<li class="list-group-item d-flex justify-content-between align-items-center"><strong>${item.key}</strong><span>${item.val}</span></li>`
                    )
                    .join("")
                : "<li class='list-group-item text-center text-muted'>âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ§Ø­Ø©.</li>";

              return `<div class="tab-pane fade" id="content-${i}" role="tabpanel"><ul class="list-group list-group-flush">${sectionItems}</ul></div>`;
            })
            .join("");

          modalBody.innerHTML = `
      <ul class="nav nav-tabs justify-content-center flex-wrap" id="specTabs" role="tablist">${navTabs}</ul>
      <div class="tab-content p-3 border border-top-0 rounded-bottom bg-light mt-1" id="specTabsContent">${tabContents}</div>
    `;

          new bootstrap.Modal(document.getElementById("specsModal")).show();
        } catch (err) {
          console.error(err);
          modalBody.innerHTML = `<div class='alert alert-danger text-center'>âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</div>`;
        }
      }
    </script>

    <script>
      const form = document.getElementById("searchForm");
      const input = document.getElementById("phoneInput");
      const resultDiv = document.getElementById("result");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const phone = input.value.trim();
        if (!phone) return;
        resultDiv.innerHTML = `<div class='alert alert-info'>ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† "${phone}"...</div>`;

        try {
          const res = await fetch(`/api/${encodeURIComponent(phone)}`);
          const data = await res.json();
          if (data.error) {
            resultDiv.innerHTML = `<div class='alert alert-danger'>âŒ ${data.error}</div>`;
            return;
          }

          if (!data.mode || data.mode === "list") {
            let cards = "<div class='row justify-content-start g-3'>";
            for (const item of data.results) {
              // âœ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†ØµÙˆØµ (Ù„Ùˆ ÙÙŠÙ‡Ø§ Ø£ÙƒØ«Ø± Ù…Ù† Ù…ÙˆØ¯ÙŠÙ„ Ø£Ùˆ Ù…Ø¹Ø§Ù„Ø¬)
              const chipsetText = Array.isArray(item.chipset) ? item.chipset.join(", ") : item.chipset || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯";

              const modelText = Array.isArray(item.model) ? item.model.join(", ") : item.model || "";

cards += `
  <div class="col-6 col-sm-4 col-md-3 col-lg-custom mb-4">
    <div class="result-item shadow-sm rounded-3 p-2 h-100"
         data-url="${item.link}"
         data-img="${item.img || ""}"
         style="cursor:pointer; background:#fff; transition: transform 0.2s, box-shadow 0.2s;">
         
      ${item.img ? `<img src="${item.img}" class="result-thumb rounded mb-2" style="width:100%; height:180px; object-fit:cover;" alt="${item.title}">` : ""}

      <div class="text-center">
        <div class="fw-bold mb-1">${item.title}</div>

        <!-- Ø²Ø± Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬ -->
        <button type="button"
          class="btn btn-sm btn-outline-primary w-100 mb-1 text-truncate"
          style="direction:ltr;"
          data-bs-toggle="popover"
          data-bs-trigger="hover focus"
          title="âš™ï¸ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬"
          data-bs-content="${item.chipsetTooltip || chipsetText}">
          ${chipsetText}
        </button>

        <!-- Ø²Ø± Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ -->
        ${modelText ? `
        <button type="button"
          class="btn btn-sm btn-outline-success w-100 text-truncate"
          style="direction:ltr;"
          data-bs-toggle="popover"
          data-bs-trigger="hover focus"
          title="ğŸ“± Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ ÙˆØ§Ù„Ø·Ø±Ø§Ø²"
          data-bs-content="${item.modelTooltip || modelText}">
          ${modelText}
        </button>` : ""}
      </div>
    </div>
  </div>
`;

            }

            cards += "</div>";
            resultDiv.innerHTML = cards;

            // âœ… ØªÙØ¹ÙŠÙ„ popover Ù…Ù† Bootstrap Ø¨Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙƒØ±ÙˆØª
            const popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
            popoverTriggerList.map(
              (el) =>
                new bootstrap.Popover(el, {
                  placement: "top",
                  container: "body",
                  html: true,
                })
            );

            // âœ… Ø£Ù†Ù…Ø§Ø· CSS Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙˆØ³Ù‘Ø¹ ÙˆØ¬Ø¹Ù„ Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„ÙŠØ³Ø§Ø± Ø¥Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ†
            const style = document.createElement("style");
            style.innerHTML = `
   .truncate-hover {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      transition: none !important;
      transform: none !important;
      direction: ltr; /* â† Ø¹Ø±Ø¶ Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„Ø´Ù…Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† */
      text-align: left !important;
   }
  `;
            document.head.appendChild(style);
            // Ø³ÙƒØ±Ø¨Øª ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª
            document.querySelectorAll(".chipset-badge, .model-badge").forEach((badge) => {
              const tooltip = badge.querySelector(".tooltip");
              badge.addEventListener("mouseenter", () => {
                tooltip.style.opacity = "1";
                tooltip.style.pointerEvents = "auto";
              });
              badge.addEventListener("mouseleave", () => {
                tooltip.style.opacity = "0";
                tooltip.style.pointerEvents = "none";
              });
            });
          } else if (data.mode === "details") {
            let specsHtml = "";
            for (const [key, val] of Object.entries(data.specs))
              specsHtml += `<li><strong>${key}:</strong> ${val}</li>`;

resultDiv.innerHTML = `
  <div class="col mb-4">
    <div class="card phone-card" data-url="${item.link}" data-img="${item.img}">
      <img src="${item.img}" class="card-img-top" alt="${item.title}">
      <div class="card-body">
        <h6 class="card-title">${item.title}</h6>
        <button class="btn btn-outline-primary btn-sm mb-2">${item.chipset}</button>
        <button class="btn btn-outline-success btn-sm">${item.model}</button>
      </div>
    </div>
  </div>
`;

                        }
                       } catch (err) {
                        resultDiv.innerHTML = `<div class='alert alert-danger'>âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</div>`;
                            }
                           });

      // ğŸ§  Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª
      document.addEventListener("click", (e) => {
        const badge = e.target.closest(".chipset-badge");
        if (!badge) return;
        const tooltipText = badge.getAttribute("data-tooltip");
        if (!tooltipText) return;
        document.querySelectorAll(".tooltip-popup").forEach((el) => el.remove());
        const tooltip = document.createElement("div");
        tooltip.className = "tooltip-popup";
        tooltip.textContent = tooltipText;
        document.body.appendChild(tooltip);
        const rect = badge.getBoundingClientRect();
        tooltip.style.top = `${rect.bottom + window.scrollY + 10}px`;
        tooltip.style.left = `${rect.left + window.scrollX}px`;
        const closeTooltip = (ev) => {
          if (!tooltip.contains(ev.target) && ev.target !== badge) {
            tooltip.remove();
            document.removeEventListener("click", closeTooltip);
          }
        };
        setTimeout(() => document.addEventListener("click", closeTooltip), 10);
      });
      document.addEventListener("mouseover", (e) => {
        const badge = e.target.closest(".chipset-badge");
        if (!badge) return;
        const tooltipText = badge.getAttribute("data-tooltip");
        if (!tooltipText) return;
        if (badge.dataset.tooltipOpen === "true") return;
        badge.dataset.tooltipOpen = "true";
        const tooltip = document.createElement("div");
        tooltip.className = "tooltip-popup";
        tooltip.textContent = tooltipText;
        document.body.appendChild(tooltip);
        const rect = badge.getBoundingClientRect();
        tooltip.style.top = `${rect.bottom + window.scrollY + 10}px`;
        tooltip.style.left = `${rect.left + window.scrollX}px`;
        badge.addEventListener(
          "mouseleave",
          () => {
            tooltip.remove();
            badge.dataset.tooltipOpen = "false";
          },
          { once: true }
        );
      });

      // ğŸŸ¢ ÙØªØ­ Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø¨Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¨Ø­Ø«
      // Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù†ÙØ³Ù‡Ø§
      resultDiv.addEventListener("click", (e) => {
        const card = e.target.closest(".phone-card");
        if (!card) return;
        getDetails(card.dataset.url, card.dataset.img);
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>


