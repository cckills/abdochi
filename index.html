<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>بحث عن الهواتف</title>

    <!-- Bootstrap CSS (كما في النسخة الأصلية) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Font Awesome CDN (إن رغبت باستعمال أيقونات إضافية لاحقًا) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <style>
      /* ===========================
         التنسيقات العامة والهيكل
         (تعليقات بالعربية لتسهيل الصيانة)
         =========================== */

      /* خط النظام الافتراضي كما طلبت */
      body {
        background: #f7f8fb;
        font-family: Tahoma, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        color: #222;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* صندوق البحث المركزي */
      .search-modal-box {
        max-width: 720px;
        margin: 48px auto;
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 6px 22px rgba(13, 110, 253, 0.06);
        padding: 26px;
      }

      /* زر البحث الرئيسي */
      .search-field {
        width: 100%;
        padding: 12px 14px;
        border: 2px solid #e6e9ee;
        border-radius: 12px;
        font-size: 16px;
        transition: box-shadow .15s, border-color .15s;
      }
      .search-field:focus {
        outline: none;
        border-color: #bcd7ff;
        box-shadow: 0 6px 18px rgba(13,110,253,0.06);
      }

      .message {
        margin-top: 10px;
        color: #6c757d;
        font-size: 14px;
      }

      /* ===========================
         بطاقات نتائج البحث (شبكة مرنة)
         =========================== */

      #result {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: center;
      }

      /* تعريف بطاقات الهواتف بمرونة واحدة فقط */
      .phone-card {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 100%;
        background-color: #fff;
        border-radius: 14px;
        box-shadow: 0 6px 18px rgba(22, 28, 45, 0.06);
        transition: transform .18s ease, box-shadow .18s ease;
        cursor: pointer;
        overflow: hidden;
        border: 1px solid rgba(12, 28, 55, 0.04);
      }
      .phone-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 18px 40px rgba(13, 110, 253, 0.08);
      }

      /* صورة البطاقة */
      .phone-card .card-img-top {
        width: 100%;
        height: 180px;
        object-fit: cover;
        display: block;
      }

      /* محتوى البطاقة */
      .phone-card .card-body {
        padding: 14px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .phone-card .card-title {
        font-size: 15px;
        font-weight: 700;
        color: #0d6efd;
        text-align: center;
        min-height: 46px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* أزرار chipset / model داخل البطاقة */
      .chipset-btn,
      .model-btn {
        display: block;
        width: 100%;
        text-align: left;
        direction: ltr;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        font-size: 13px;
        border-radius: 8px;
      }

      .chipset-btn { border-color: rgba(13,110,253,0.15); color: #0d6efd; }
      .model-btn { border-color: rgba(25,135,84,0.12); color: #198754; }

      /* توزيع الأعمدة بحسب العرض */
      .col-lg-custom {
        flex: 0 0 20%;
        max-width: 20%;
      }
      @media (max-width: 1199.98px) {
        .col-lg-custom { flex: 0 0 33.3333%; max-width: 33.3333%; }
      }
      @media (max-width: 767.98px) {
        .col-lg-custom { flex: 0 0 48%; max-width: 48%; }
      }
      @media (max-width: 479.98px) {
        .col-lg-custom { flex: 0 0 100%; max-width: 100%; }
      }

      /* صف النتائج: تباعد متناسق */
      .results-row {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
      }

      /* ===========================
         بطاقات المواصفات (داخل المودال)
         =========================== */

      .aps-feature-card {
        background: linear-gradient(180deg, #f8fbff 0%, #ffffff 100%);
        padding: 16px;
        border-radius: 12px;
        box-shadow: 0 6px 18px rgba(12, 28, 55, 0.04);
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .aps-list-icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 22px;
        color: #fff;
        margin-bottom: 10px;
      }

      /* أيقونات ملونة لكل نوع */
      .aps-icon-mobile { background: #0d6efd; }
      .aps-icon-cpu { background: #198754; }
      .aps-icon-camera { background: #fd7e14; }
      .aps-icon-hdd { background: #6f42c1; }
      .aps-icon-code { background: #20c997; }
      .aps-icon-battery { background: #ffc107; color: #000; }

      .aps-feature-info strong { color: #111; font-size: 15px; }
      .aps-feature-info span { font-size: 14px; color: #333; text-align: center; }

      /* تنسيق تبويبات المودال */
      .nav-tabs { overflow-x: auto; white-space: nowrap; -webkit-overflow-scrolling: touch; }
      .nav-tabs .nav-link { font-weight: 600; color: #0d6efd; border-radius: 10px 10px 0 0; margin: 2px; }
      .nav-tabs .nav-link.active { background-color: #0d6efd; color: #fff; }

      /* tooltip-popup (في حال استخدامه مستقبلاً) */
      .tooltip-popup {
        position: absolute;
        background: #222;
        color: #fff;
        padding: 8px 10px;
        border-radius: 8px;
        font-size: 13px;
        max-width: 260px;
        line-height: 1.5;
        z-index: 9999;
        box-shadow: 0 6px 20px rgba(0,0,0,0.25);
      }

      /* تحسينات صغيرة للعرض */
      .aps-main-image img { width: 100%; height: auto; border-radius: 10px; }
      .card-title small { display:block; color:#6c757d; font-weight:400; }

    </style>
  </head>
  <body>
    <div class="container">

      <!-- ===== مربع البحث (مركز) ===== -->
      <div class="search-modal-box">
        <div class="card border-0">
          <div class="card-body">
            <h5 class="text-center mb-3 fw-bold text-primary">🔍 بحث عن الهواتف</h5>
            <form id="searchForm" class="text-center" autocomplete="off">
              <p class="message mb-3">اكتب كلمة البحث ثم اضغط زر البحث أو <em>Enter</em></p>
              <input
                type="search"
                class="search-field mb-3 text-center"
                id="phoneInput"
                name="s"
                placeholder="ابحث عن اسم الهاتف..."
                required
              />
              <button type="submit" class="btn btn-primary w-100 py-2 fw-bold">بحث</button>
            </form>
          </div>
        </div>
      </div>

      <!-- ===== نتائج البحث ===== -->
      <div class="card shadow-sm border-0 rounded-4 mb-4">
        <div class="card-body">
          <h5 class="text-center mb-4 text-primary fw-bold">📱 نتائج البحث</h5>
          <div id="result" class="row g-4 justify-content-center"></div>
        </div>
      </div>

    </div>

    <!-- ===== مودال عرض المواصفات ===== -->
    <div class="modal fade" id="specsModal" tabindex="-1" aria-labelledby="specsModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content shadow-lg rounded-4">
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title" id="modalTitle">تفاصيل الهاتف</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="إغلاق"></button>
          </div>
          <div class="modal-body" id="specsModalBody">
            <div class="text-center py-5">
              <div class="spinner-border text-primary" role="status"></div>
              <p class="mt-3 text-muted">جاري التحميل...</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===========================
         سكربتات JavaScript (منقّحة)
         =========================== -->
    <script>
      // -----------------------------
      // مُعالجة عرض التفاصيل في المودال
      // -----------------------------
      async function getDetails(url, phoneImg) {
        const modalBody = document.getElementById("specsModalBody");
        modalBody.innerHTML = `<div class='alert alert-info text-center'>📱 جاري جلب المواصفات...</div>`;

        try {
          const res = await fetch(`/api/details?url=${encodeURIComponent(url)}`);
          const data = await res.json();

          if (data.error) {
            modalBody.innerHTML = `<div class='alert alert-danger text-center'>❌ ${data.error}</div>`;
            return;
          }

          // ---------- تعريف أقسام العرض والرموز ----------
          const sections = {
            "نظرة عامة": ["الإصدار", "الماركة", "الاسم", "النوع", "الخامة"],
            "السعر": ["السعر", "Price", "الأسعار"],
            "النظام": ["نظام التشغيل", "الواجهة", "الإصدار"],
            "الشاشة": ["الشاشة", "النوع", "الدقة", "السطوع", "معدل التحديث"],
            "الذاكرة": ["الذاكرة", "التخزين", "SD", "الرام"],
            "الأبعاد": ["الأبعاد", "الوزن", "الحجم"],
            "الكاميرا": ["الكاميرا", "الخلفية", "الأمامية", "الفيديو"],
            "البطارية": ["البطارية","الشحن","السعة"],
            "الصوت": ["الصوت", "سماعات", "جاك"],
            "أخرى": []
          };

          const icons = {
            "نظرة عامة": "📋",
            "السعر": "💰",
            "النظام": "⚙️",
            "الشاشة": "📱",
            "الذاكرة": "💾",
            "الأبعاد": "📏",
            "الكاميرا": "📸",
            "البطارية": "🔋",
            "الصوت": "🔈",
            "أخرى": "📎"
          };

          // ---------- تجميع البيانات حسب الأقسام ----------
          const grouped = {};
          if (data.specs && typeof data.specs === "object") {
            for (const [key, val] of Object.entries(data.specs)) {
              let found = false;
              for (const [section, keywords] of Object.entries(sections)) {
                if (keywords.some((k) => key.includes(k))) {
                  (grouped[section] ??= []).push({ key, val });
                  found = true;
                  break;
                }
              }
              if (!found) (grouped["أخرى"] ??= []).push({ key, val });
            }
          }

          // ---------- دوال مساعدة (تنظيف و استخراج) ----------
          function extractScreenInfo(screenRaw) {
            if (!screenRaw) return "غير محددة";
            const text = String(screenRaw);

            const typeMatch = text.match(/(IPS\s*LCD|AMOLED|OLED|Super\s*AMOLED|LTPO|PLS|TFT)/i);
            const type = typeMatch ? typeMatch[0].replace(/\s+/g, " ").trim().toUpperCase() : "";

            const sizeMatch = text.match(/(\d+(\.\d+)?)\s*(بوصة|بوصه|inch|")/i);
            const size = sizeMatch ? `${sizeMatch[1]} بوصة` : "";

            let res = "";
            if (/FHD/i.test(text)) res = "بدقة FHD+";
            else if (/HD\+/i.test(text)) res = "بدقة HD+";
            else if (/QHD/i.test(text)) res = "بدقة QHD+";
            else if (/UHD|4K/i.test(text)) res = "بدقة 4K";
            else {
              const resMatch = text.match(/(\d{3,4})\s*[x×]\s*(\d{3,4})/i);
              if (resMatch) {
                const width = Math.max(resMatch[1], resMatch[2]);
                res = width >= 2000 ? "بدقة FHD+" : "بدقة HD+";
              }
            }

            if (type || size || res) {
              return `${type}${type && size ? " بحجم " : ""}${size}${(type || size) && res ? " " : ""}${res}`.trim();
            } else {
              return text;
            }
          }

          function extractCameraMP(textRaw) {
            if (!textRaw) return "غير محددة";
            const text = String(textRaw);
            const matches = text.match(/(\d+)\s*(?:ميجا|م\.ب|MP|mp)/gi);
            if (!matches) return "غير محددة";
            const clean = matches.map((m) => m.replace(/\D/g, ""));
            return clean.join("+") + " م.ب";
          }

          function extractMemoryInfo(specsObj) {
            const storageKey = Object.keys(specsObj || {}).find((k) => /ذاكرة|تخزين|داخلية/i.test(k)) || "";
            const ramKey = Object.keys(specsObj || {}).find((k) => /رام|الرامات|عشوائية/i.test(k)) || "";
            const storage = storageKey ? String(specsObj[storageKey]).replace(/\s*\.\s*$/, "") : "";
            const ram = ramKey ? String(specsObj[ramKey]).replace(/\s*\.\s*$/, "") : "";
            if (storage && ram) return `${storage} + ${ram}`;
            else if (storage) return storage;
            else if (ram) return ram;
            else return "غير محددة";
          }

          function extractBatteryInfo(specsObj) {
            const capacity = specsObj["سعة البطارية"] || specsObj["Battery Capacity"] || "";
            const charging = specsObj["قدرة الشحن"] || specsObj["الشحن"] || "";
            if (!capacity && !charging) return "غير محددة";

            let capClean = "";
            if (capacity) {
              capClean = String(capacity).replace(/ملي|مللي|mAh/gi, "").trim().replace(/\.+$/, "");
              if (capClean) capClean = `${capClean} م.أ`;
            }
            let chargeClean = "";
            if (charging) {
              chargeClean = String(charging).replace(/واط|W/gi, "").trim().replace(/\.+$/, "");
              if (chargeClean) chargeClean = `${chargeClean} واط`;
            }
            if (capClean && chargeClean) return `${capClean} / ${chargeClean}`;
            if (capClean) return capClean;
            if (chargeClean) return chargeClean;
            return "غير محددة";
          }

          // ---------- بناء التبويبات والمحتويات ----------
          const tabs = Object.keys(sections);
          const navTabs = tabs
            .map(
              (tab, i) => `
              <li class="nav-item" role="presentation">
                <button class="nav-link ${i === 0 ? "active" : ""}" id="tab-${i}" data-bs-toggle="tab" data-bs-target="#content-${i}" type="button" role="tab">
                  ${icons[tab] || ""} ${tab}
                </button>
              </li>`
            )
            .join("");

          const tabContents = tabs
            .map((tab, i) => {
              // تبويب "نظرة عامة" يبني الكروت المختصرة والرئيسية
              if (tab === "نظرة عامة") {
                const mainImage = phoneImg || data.img || "";
                const title = data.title || "غير معروف";

                // مجموعة بطاقات قصيرة تعرض المعلومات الأساسية (تُحافظ على نفس المنطق الأصلي)
                const shortCards = [
                  {
                    key: "الشاشة",
                    val: extractScreenInfo(data.specs?.["الشاشة"] || data.specs?.["Display"] || grouped["الشاشة"]?.[0]?.val || ""),
                    icon: "aps-icon-mobile",
                  },
                  {
                    key: "المعالج",
                    val: data.specs?.["المعالج"] || data.specs?.["Chipset"] || grouped["النظام"]?.[0]?.val || "غير محدد",
                    icon: "aps-icon-cpu",
                  },
                  {
                    key: "الكاميرات",
                    val: (() => {
                      const backRaw = data.specs?.["كاميرا خلفية"] || data.specs?.["الكاميرا الخلفية"] || data.specs?.["Back Camera"] || "";
                      const frontRaw = data.specs?.["كاميرا امامية"] || data.specs?.["الكاميرا الأمامية"] || data.specs?.["Front Camera"] || "";
                      const back = extractCameraMP(backRaw);
                      const front = extractCameraMP(frontRaw);
                      if (back !== "غير محددة" && front !== "غير محددة") return `خلفية ${back} / أمامية ${front}`;
                      if (back !== "غير محددة") return `خلفية ${back}`;
                      if (front !== "غير محددة") return `أمامية ${front}`;
                      return "غير محددة";
                    })(),
                    icon: "aps-icon-camera",
                  },
                  {
                    key: "الذاكرة + الرام",
                    val: extractMemoryInfo(data.specs),
                    icon: "aps-icon-hdd",
                  },
                  {
                    key: "نظام التشغيل",
                    val: data.specs?.["نظام التشغيل"] || data.specs?.["OS"] || "غير محدد",
                    icon: "aps-icon-code",
                  },
                  {
                    key: "البطارية",
                    val: extractBatteryInfo(data.specs),
                    icon: "aps-icon-battery",
                  }
                ];

                const cardsHtml = shortCards
                  .map(
                    (item) => `
                    <div class="col-12 col-md-6 mb-3">
                      <div class="aps-feature-card">
                        <div class="aps-list-icon ${item.icon}">${/* أيقونات رمزية إن احتجت */ ""}</div>
                        <div class="aps-feature-info text-center mt-1">
                          <strong>${item.key}</strong><br>
                          <span>${item.val}</span>
                        </div>
                      </div>
                    </div>`
                  )
                  .join("");

                return `
                  <div class="tab-pane fade show active" id="content-${i}" role="tabpanel">
                    <div class="d-flex flex-column flex-lg-row align-items-center gap-4">
                      <div class="text-center flex-shrink-0">
                        <div class="aps-main-image mb-3" style="max-width:400px;">
                          <img fetchpriority="high" class="rounded shadow-sm" src="${mainImage}" alt="${title}" onerror="this.src='https://via.placeholder.com/400x300?text=No+Image'">
                        </div>
                        <h4 class="fw-bold mt-2">${title}</h4>
                      </div>

                      <div class="flex-grow-1 w-100">
                        <div class="row g-3">
                          ${cardsHtml}
                        </div>
                      </div>
                    </div>
                  </div>`;
              }

              // تبويب السعر (عرض خاص)
              if (tab === "السعر") {
                const priceVal = grouped["السعر"]?.[0]?.val || "غير متوفر";
                return `<div class="tab-pane fade" id="content-${i}" role="tabpanel">
                  <div class="card border-success text-center shadow-sm p-4 bg-light">
                    <h4 class="text-success fw-bold mb-3">💰 السعر</h4>
                    <p class="fs-4 text-success">${priceVal}</p>
                  </div>
                </div>`;
              }

              // بقية التبويبات: عرض قائمة key - value أو رسالة عدم توفر بيانات
              const sectionItems = grouped[tab]?.length
                ? grouped[tab]
                    .map(
                      (item) =>
                        `<li class="list-group-item d-flex justify-content-between align-items-center"><strong>${item.key}</strong><span>${item.val}</span></li>`
                    )
                    .join("")
                : "<li class='list-group-item text-center text-muted'>❌ لا توجد بيانات متاحة.</li>";

              return `<div class="tab-pane fade" id="content-${i}" role="tabpanel"><ul class="list-group list-group-flush">${sectionItems}</ul></div>`;
            })
            .join("");

          // إدراج المحتوى في المودال
          modalBody.innerHTML = `
            <ul class="nav nav-tabs justify-content-center flex-wrap" id="specTabs" role="tablist">${navTabs}</ul>
            <div class="tab-content p-3 border border-top-0 rounded-bottom bg-light mt-1" id="specTabsContent">${tabContents}</div>
          `;

          // عرض المودال عبر Bootstrap
          const modalEl = document.getElementById("specsModal");
          const modalInstance = new bootstrap.Modal(modalEl);
          modalInstance.show();
        } catch (err) {
          console.error(err);
          modalBody.innerHTML = `<div class='alert alert-danger text-center'>⚠️ حدث خطأ أثناء جلب البيانات.</div>`;
        }
      }

      // -----------------------------
      // البحث وعرض البطاقات في #result
      // -----------------------------
      (function setupSearchHandler() {
        const form = document.getElementById("searchForm");
        const input = document.getElementById("phoneInput");
        const resultDiv = document.getElementById("result");

        form.addEventListener("submit", async (e) => {
          e.preventDefault();
          const phone = input.value.trim();
          if (!phone) return;

          // رسالة انتظار
          resultDiv.innerHTML = `<div class='alert alert-info w-100 text-center'>🔍 جاري البحث عن "${phone}"...</div>`;

          try {
            const res = await fetch(`/api/${encodeURIComponent(phone)}`);
            const data = await res.json();

            if (data.error) {
              resultDiv.innerHTML = `<div class='alert alert-danger w-100 text-center'>❌ ${data.error}</div>`;
              return;
            }

            // وضع منفصل لقائمة النتائج (list mode) أو تفاصيل مفردة (details mode)
            if (!data.mode || data.mode === "list") {
              // عرض شبكة من البطاقات
              let cards = "";
              if (!Array.isArray(data.results) || data.results.length === 0) {
                cards = `<div class="alert alert-warning w-100 text-center">لم يتم العثور على نتائج.</div>`;
              } else {
                for (const item of data.results) {
                  const chipsetText = Array.isArray(item.chipset) ? item.chipset.join(", ") : item.chipset || "غير محدد";
                  const modelText = Array.isArray(item.model) ? item.model.join(", ") : item.model || "";
                  const imgHtml = item.img
                    ? `<div class="card-img-wrapper position-relative" style="z-index:1;">
                         <img src="${item.img}" class="card-img-top rounded-top" alt="${item.title}" onerror="this.src='https://via.placeholder.com/400x300?text=No+Image'">
                       </div>`
                    : "";

                  cards += `
                    <div class="col-lg-custom mb-3" style="flex:0 0 20%; max-width:20%;">
                      <div class="card phone-card shadow-sm rounded-4 h-100 position-relative"
                           data-url="${item.link || ''}"
                           data-img="${item.img || ''}"
                           data-title="${(item.title || '').replace(/"/g, '&quot;')}"
                           style="min-width:220px;">
                        ${imgHtml}
                        <div class="card-body text-center d-flex flex-column position-relative" style="overflow: visible; z-index:2;">
                          <h6 class="card-title fw-bold mb-2">${item.title || 'بدون عنوان'}</h6>
                          <div class="d-flex flex-column gap-2 text-muted small w-100">
                            <button type="button"
                              class="btn btn-sm btn-outline-primary chipset-btn px-3 py-1"
                              data-bs-toggle="popover"
                              data-bs-trigger="hover focus"
                              title="⚙️ نوع المعالج"
                              data-bs-content="${(item.chipsetTooltip || chipsetText || '').replace(/"/g, '&quot;')}">
                              ${chipsetText}
                            </button>
                            ${modelText ? `<button type="button"
                              class="btn btn-sm btn-outline-success model-btn px-3 py-1"
                              data-bs-toggle="popover"
                              data-bs-trigger="hover focus"
                              title="📱 الموديل والطراز"
                              data-bs-content="${(item.modelTooltip || modelText || '').replace(/"/g, '&quot;')}">
                              ${modelText}
                            </button>` : ''}
                          </div>
                        </div>
                      </div>
                    </div>`;
                }
              }

              // إدراج النتائج
              resultDiv.innerHTML = `<div class="results-row w-100">${cards}</div>`;

              // تفعيل popovers من Bootstrap
              const popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
              popoverTriggerList.map((el) =>
                new bootstrap.Popover(el, {
                  placement: "top",
                  container: "body",
                  html: true,
                })
              );

              // ضبط استجابة الأعمدة للعرض (تعويض flex values للمتصفحات)
              // تم الاحتفاظ باستخدام الكلاسات المرنة أعلاه في CSS
            } else if (data.mode === "details") {
              // في حالة mode: details نعرض بطاقة مفردة باستخدام بيانات data (وليس item غير معروف)
              const img = data.img || '';
              const title = data.title || 'بدون عنوان';
              const chipset = data.chipset || '';
              const model = data.model || '';

              resultDiv.innerHTML = `
                <div class="w-100">
                  <div class="card phone-card p-0" data-url="${data.link || ''}" data-img="${img}">
                    ${img ? `<img src="${img}" class="card-img-top" alt="${title}" onerror="this.src='https://via.placeholder.com/400x300?text=No+Image'">` : ''}
                    <div class="card-body">
                      <h6 class="card-title">${title}</h6>
                      ${chipset ? `<button class="btn btn-outline-primary btn-sm mb-2">${chipset}</button>` : ''}
                      ${model ? `<button class="btn btn-outline-success btn-sm">${model}</button>` : ''}
                    </div>
                  </div>
                </div>
              `;
            }
          } catch (err) {
            console.error(err);
            resultDiv.innerHTML = `<div class='alert alert-danger w-100 text-center'>⚠️ حدث خطأ أثناء جلب البيانات.</div>`;
          }
        });

        // فتح المودال عند النقر على أي بطاقة (delegation على #result)
        resultDiv.addEventListener("click", (e) => {
          const card = e.target.closest(".phone-card");
          if (!card) return;
          const url = card.dataset.url || "";
          const img = card.dataset.img || "";
          getDetails(url, img);
        });
      })();
    </script>

    <!-- Bootstrap Bundle JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
